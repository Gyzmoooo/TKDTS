import sys
import time
import re
import traceback
import os

import requests
import pandas as pd
from joblib import load

# --- Costanti e Configurazioni 
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
MODEL_PATH = BASE_DIR.strip("src\python") + '\model\\rf_model.sav'

URL_FETCH = "http://192.168.4.1/"
URL_DELETE = f"{URL_FETCH}delete"

TIMESTEPS = 20
NUM_BOARDS = 4
SENSORS = ['A', 'G']
AXES = ['x', 'y', 'z']

EXPECTED_ESP_IDS = [str(i + 1) for i in range(NUM_BOARDS)]
NUM_DATA_PER_TIMESTEP = len(SENSORS) * len(AXES) * NUM_BOARDS
EXPECTED_DATA_COLUMNS = TIMESTEPS * NUM_DATA_PER_TIMESTEP

MAX_FETCH_ATTEMPTS = 2
RETRY_DELAY_SECONDS = 2

class UnsufficientSamples(Exception):
    """Exception raised when the number of samples received is less than expected"""
    def __init__(self, e_samples, r_samples, msg="Samples received is less than expected"):
        self.message = (
            f"{msg}: Received {r_samples}, Expected {e_samples}. "
        )
        super().__init__(self.message)

class UncompleteData(Exception):
    """Exception raised when at least one of the ESP32 didn't send any data"""
    def __init__(self, e_ids, r_ids, msg=" of the ESP32 didn't send any data"):
        self.empty_ids = [esp_id for esp_id in e_ids if esp_id not in r_ids]
        self.message = (
            f"{len(self.empty_ids)}{msg}. IDs of the boards: {self.empty_ids}. "
        )
        super().__init__(self.message)



class DataProcessor:
    def __init__(self, url_delete, timesteps, num_boards, sensors, axes, expected_esp_ids):
        self.url_delete = url_delete
        self.timesteps = timesteps
        self.num_boards = num_boards
        self.sensors = sensors
        self.axes = axes
        self.expected_esp_ids = expected_esp_ids


    def generate_column_names(self):
        column_names = []
        for i in range(self.timesteps):
            suffix = f"_{i + 1}"
            for board_id in range(1, self.num_boards + 1):
                for sensor_type in self.sensors:
                    for axis in self.axes:
                        col_name = f"{sensor_type}{board_id}{axis}{suffix}"
                        column_names.append(col_name)
        return column_names

    def parse_data(self, raw_data):
        number_pattern = r'-?\d+\.?\d*'
        esp_data = []
        
        # Parses all data and stores them in a list
        for esp_id in self.expected_esp_ids:
            last_start_idx = raw_data.rfind(f"Start{esp_id};")
            last_end_idx = raw_data.find(f"End{esp_id};", last_start_idx + len(f"Start{esp_id};"))
            if last_end_idx != -1 and last_start_idx != -1:
                esp_block = raw_data[last_start_idx + len(f"Start{esp_id};") : last_end_idx]
                esp_block = esp_block.replace(f"ID{esp_id}", "")
                esp_data.append([float(num_str) for num_str in re.findall(number_pattern, esp_block)])
            else: esp_data.append([])

        return esp_data

    def format_data(self, esp_data):
        # Verifies data completeness and number of samples
        active_esp_ids = [str(esp_id + 1) for esp_id in range(len(esp_data)) if esp_data[esp_id] != []]
        samples_counts = [(len(esp_data[int(esp_id) - 1]) / 6) for esp_id in active_esp_ids]
        min_samples = int(min(samples_counts))
        #print(f"QUESTO è len(samples_counts): {len(samples_counts)}")
        #print(f"QUESTO è self.num_boards: {self.num_boards}")
        if self.timesteps > 0 and len(samples_counts) != self.num_boards: 
            raise UncompleteData(e_ids=self.expected_esp_ids, r_ids=active_esp_ids)
        elif min_samples < self.timesteps:
            raise UnsufficientSamples(e_samples=self.timesteps, r_samples=min_samples)

        # Eliminates excessive data
        for esp in range(self.num_boards):
            data_to_eliminate = int(-6 * (samples_counts[int(esp)] - min_samples) - 1)
            del esp_data[esp][-1:data_to_eliminate:-1]

        # Conversion in list of lists format, where each sublist contains a single sample
        unfiltered_data = []
        for i in range(min_samples):
            sample = []
            for j in range(self.num_boards):
                start = i * len(self.sensors) * len(self.axes)
                end = start + len(self.sensors) * len(self.axes)
                sample.extend(esp_data[j][start:end])
            unfiltered_data.append(sample)
        
        # Sample reduction to 20
        data = [[]]
        step = (len(unfiltered_data) - 1) / (self.timesteps - 1)
        for i in range(self.timesteps):
            index = round(i * step)
            for j in unfiltered_data[min(index, len(unfiltered_data) - 1)]: data[0].append(j)

        return data
    
    def delete_data_on_master(self):
        try:
            print("Sending DELETE request at", self.url_delete)
            response = requests.get(self.url_delete, timeout=5)
            if response.status_code == 200 and "OK" in response.text:
                return True
            else:
                print(f"Error sending DELETE command: Status {response.status_code}, Response: {response.text}")
                return False
        except requests.exceptions.Timeout:
            print(f"Timeout during DELETE request at {self.url_delete}")
            return False
        except requests.exceptions.RequestException as e:
            print(f"Error during communication with Master (DELETE): {e}")
            return False
        except Exception as e:
            print(f"Generic error during DELETE: {e}")
            return False
    
    def correct_data(self, raw):
        """
        Analizza una stringa di dati da sensori e aggiunge i tag 'End' mancanti.

        Args:
            dati_grezzi: La stringa di dati non elaborata, con elementi separati da ';'.

        Returns:
            Una stringa di dati corretta con tutti i blocchi
            opportunamente chiusi da un tag End<N>.
        """
        components = [part for part in raw.split(';') if part]
        if not components:
            return ""
        correct_parts = []
        id = None
        for comp in components:
            if comp.startswith('Start'):
                if id is not None:
                    correct_parts.append(f"End{id}")
                match = re.search(r'\d+', comp)
                if match:
                    id = match.group(0)
                correct_parts.append(comp)
            elif comp.startswith('End'):
                correct_parts.append(comp)
                id = None
            else:
                correct_parts.append(comp)
        if id is not None:
            correct_parts.append(f"End{id};")

        return ';'.join(correct_parts)
        
if __name__ == "__main__":
    data_processor = DataProcessor(
        url_delete=URL_DELETE,
        timesteps=TIMESTEPS,
        num_boards=NUM_BOARDS,
        sensors=SENSORS,
        axes=AXES,
        expected_esp_ids=EXPECTED_ESP_IDS
    )

    #raw = "Start1;ID1;A:-0.3736,9.5897,-1.0251;G:0.0192,0.1389,-0.0090;ID1;A:-0.1629,9.6519,-0.9101;G:0.0442,0.0229,0.0037;ID1;A:0.0144,9.6519,-0.7520;G:0.0474,0.0208,-0.0005;ID1;A:0.0719,9.6519,-0.8814;G:0.0165,0.0229,-0.0059;ID1;A:-0.1868,9.6519,-0.8622;G:0.0351,-0.0883,0.0122;ID1;A:-0.1293,9.6423,-0.9005;G:0.0346,-0.1527,0.0261;ID1;A:-0.0862,9.6471,-0.9149;G:0.0399,-0.0665,0.0138;ID1;A:-0.1198,9.6328,-1.0155;G:0.0372,-0.0543,0.0074;ID1;A:-0.0862,9.6759,-0.8383;G:0.0303,-0.1437,0.0176;ID1;A:-0.0623,9.6519,-0.9915;G:0.0378,0.0011,0.0064;ID1;A:-0.1916,9.6902,-0.8574;G:0.0404,-0.0106,0.0027;ID1;A:-0.1150,9.6759,-0.8718;G:0.0335,0.0090,0.0005;ID1;A:-0.0958,9.6376,-0.8957;G:0.0335,0.0255,0.0011;ID1;A:-0.1006,9.6519,-0.8478;G:0.0362,0.0181,-0.0011;ID1;A:-0.0910,9.6184,-1.1161;G:0.0303,0.0250,-0.0011;ID1;A:-0.0814,9.6663,-0.8814;G:0.0351,0.0245,-0.0016;ID1;A:-0.1102,9.6663,-0.9628;G:0.0330,0.0255,0.0037;ID1;A:-0.1341,9.6759,-0.9053;G:0.0357,0.0282,0.0011;ID1;A:-0.1198,9.6423,-0.8909;G:0.0346,0.0271,-0.0011;ID1;A:-0.1054,9.6423,-0.9197;G:0.0341,0.0218,0.0053;ID1;A:-0.1293,9.6328,-0.9149;G:0.0367,0.0234,-0.0053;ID1;A:-0.1485,9.6328,-0.9628;G:0.0351,0.0261,0.0011;ID1;A:-0.1341,9.6567,-0.9724;G:0.0341,0.0245,0.0005;ID1;A:-0.1006,9.6136,-0.9149;G:0.0388,0.0255,0.0027;ID1;A:-0.1293,9.6807,-0.9532;G:0.0383,0.0261,0.0000;ID1;A:-0.1006,9.6615,-0.9580;G:0.0341,0.0234,0.0000;ID1;A:-0.1198,9.6567,-0.9580;G:0.0341,0.0261,0.0005;ID1;A:-0.1389,9.6471,-0.9388;G:0.0372,0.0287,0.0016;ID1;A:-0.1198,9.6376,-0.9197;G:0.0372,0.0266,0.0032;ID1;A:-0.0096,9.7190,-0.9772;G:0.0325,0.0271,0.0016;ID1;A:0.0383,9.5465,-0.8430;G:0.0378,0.0282,-0.0053;ID1;A:-0.1198,9.6519,-0.9484;G:0.0351,0.0223,-0.0043;ID1;A:-0.0910,9.6759,-0.9149;G:0.0319,0.0261,0.0016;ID1;A:-0.0766,9.6088,-0.9676;G:0.0378,0.0223,0.0000;ID1;A:-0.1150,9.6567,-0.8718;G:0.0335,0.0234,-0.0011;ID1;A:-0.0671,9.6280,-0.9293;G:0.0346,0.0250,0.0016;ID1;A:-0.1389,9.6663,-0.9963;G:0.0372,0.0250,-0.0021;ID1;A:-0.1054,9.6471,-0.9484;G:0.0362,0.0250,0.0005;ID1;A:-0.1198,9.6567,-0.9580;G:0.0357,0.0266,0.0059;ID1;A:-0.0910,9.6423,-0.9436;G:0.0335,0.0197,0.0021;ID1;A:-0.2682,9.7286,-3.5925;G:-0.2602,0.0234,-0.0027;ID1;A:-0.3401,9.7525,-0.3353;G:0.2389,0.1447,0.0223;ID1;A:-0.0719,9.7717,-1.8250;G:-0.0080,-0.0500,0.0021;ID1;A:-0.0671,9.6423,-1.1496;G:0.2198,0.1937,0.0027;ID1;A:-0.5988,9.4412,-2.5244;G:-0.2570,0.9817,-0.0117;ID1;A:-0.2491,9.6471,0.0575;G:-0.3076,0.0122,-0.0293;ID1;A:0.1485,9.7094,0.0814;G:0.2134,-0.2650,0.0287;ID1;A:-0.2587,9.6711,-1.2502;G:0.3001,0.0378,0.0149;ID1;A:-0.1868,9.7381,-0.9580;G:-0.0649,-0.5241,0.0399;End1;Start2;ID2;A:0.0096,9.5864,-0.5938;G:-0.0074,0.0048,-0.0154;ID2;A:0.0431,9.6295,-0.5555;G:-0.0117,0.0032,-0.0223;ID2;A:0.0766,9.5337,-0.6081;G:-0.0069,0.0048,-0.0218;ID2;A:0.0814,9.5720,-0.5124;G:-0.0101,0.0069,-0.0208;ID2;A:0.1006,9.5720,-0.5315;G:-0.0133,0.0053,-0.0192;ID2;A:0.0431,9.5816,-0.5555;G:-0.0154,0.0037,-0.0181;ID2;A:0.0814,9.5720,-0.5459;G:-0.0128,0.0005,-0.0186;ID2;A:0.0766,9.5481,-0.5315;G:-0.0128,0.0053,-0.0250;ID2;A:0.1101,9.5433,-0.5315;G:-0.0101,0.0069,-0.0176;ID2;A:0.1053,9.5912,-0.5794;G:-0.0096,0.0059,-0.0181;ID2;A:0.0479,9.5864,-0.5507;G:-0.0128,0.0080,-0.0202;ID2;A:0.0910,9.5960,-0.5650;G:-0.0149,0.0080,-0.0234;ID2;A:0.0479,9.6103,-0.5650;G:-0.0096,0.0021,-0.0181;ID2;A:0.0575,9.5960,-0.6081;G:-0.0138,0.0085,-0.0192;ID2;A:0.0622,9.5960,-0.5219;G:-0.0144,0.0043,-0.0181;ID2;A:0.0622,9.5768,-0.6033;G:-0.0096,0.0053,-0.0218;ID2;A:0.1053,9.5529,-0.5267;G:-0.0128,0.0074,-0.0165;ID2;A:0.0910,9.6007,-0.5459;G:-0.0133,0.0080,-0.0223;ID2;A:0.0622,9.6103,-0.5028;G:-0.0090,0.0021,-0.0186;ID2;A:0.1149,9.5864,-0.5698;G:-0.0112,0.0069,-0.0186;ID2;A:0.0670,9.5577,-0.5746;G:-0.0101,0.0059,-0.0229;ID2;A:0.0718,9.5385,-0.5794;G:-0.0154,0.0069,-0.0218;ID2;A:0.0814,9.5481,-0.5363;G:-0.0149,0.0064,-0.0197;ID2;A:0.0910,9.6103,-0.5267;G:-0.0138,0.0048,-0.0234;ID2;A:0.0862,9.5577,-0.5746;G:-0.0122,0.0037,-0.0165;ID2;A:0.1053,9.5768,-0.5698;G:-0.0122,0.0064,-0.0213;ID2;A:0.0431,9.5624,-0.5171;G:-0.0160,0.0074,-0.0202;ID2;A:0.0910,9.6247,-0.5890;G:-0.0074,0.0053,-0.0170;ID2;A:0.0575,9.5912,-0.5459;G:-0.0149,0.0059,-0.0218;ID2;A:0.0718,9.5529,-0.5794;G:-0.0122,0.0053,-0.0192;ID2;A:0.1772,9.5529,-0.1820;G:-0.0069,0.0059,-0.0112;ID2;A:0.0239,9.5816,-0.4070;G:-0.0266,0.0043,-0.0229;ID2;A:0.0670,9.5002,-0.6752;G:-0.0154,0.0059,-0.0192;ID2;A:0.1053,9.5720,-0.6704;G:-0.0059,0.0059,-0.0170;ID2;A:0.0910,9.5720,-0.6800;G:-0.0011,0.0053,-0.0154;ID2;A:0.0958,9.5624,-0.4884;G:-0.0011,0.0096,-0.0144;ID2;A:0.0718,9.5864,-0.6225;G:-0.0053,0.0080,-0.0192;ID2;A:0.0958,9.5672,-0.6129;G:-0.0074,0.0059,-0.0186;ID2;A:0.0622,9.5433,-0.5650;G:-0.0176,0.0112,-0.0197;ID2;A:0.0479,9.5337,-0.4980;G:-0.0117,0.0037,-0.0160;ID2;A:0.1197,9.5720,-0.5938;G:-0.0074,0.0090,-0.0138;ID2;A:-0.2969,9.4332,-0.5555;G:-0.0090,0.0074,-0.0165;ID2;A:-0.0575,9.5289,-0.6512;G:-0.0117,0.0048,-0.0213;ID2;A:0.0383,9.5289,-0.6512;G:-0.0133,0.0085,-0.0208;ID2;A:0.0335,9.5529,-0.5315;G:-0.0106,0.0053,-0.0223;ID2;A:0.0958,9.5960,-0.5555;G:-0.0128,0.0021,-0.0197;ID2;A:0.0718,9.5768,-0.5507;G:-0.0149,0.0069,-0.0176;ID2;A:0.0622,9.5529,-0.4741;G:-0.0128,0.0059,-0.0186;ID2;A:0.0383,9.5433,-0.5267;G:-0.0090,0.0085,-0.0160;ID2;A:0.0048,9.5146,-0.5746;G:-0.0117,0.0117,-0.0229;ID2;A:0.0431,9.5720,-0.5411;G:-0.0106,0.0048,-0.0154;ID2;A:0.1389,9.6438,-0.5602;G:-0.0144,0.0059,-0.0202;ID2;A:0.0527,9.6055,-0.5028;G:-0.0154,0.0059,-0.0186;ID2;A:0.0670,9.5481,-0.5411;G:-0.0106,0.0053,-0.0186;ID2;A:0.1006,9.5816,-0.5938;G:-0.0122,0.0080,-0.0239;ID2;A:0.0814,9.5768,-0.4884;G:-0.0133,0.0064,-0.0208;ID2;A:0.0622,9.5864,-0.5746;G:-0.0090,0.0101,-0.0213;ID2;A:0.0479,9.6055,-0.5650;G:-0.0128,0.0064,-0.0229;ID2;A:0.0910,9.5577,-0.5315;G:-0.0138,0.0090,-0.0192;ID2;A:0.0192,9.5960,-0.5124;G:-0.0117,0.0027,-0.0234;End2;Start3;ID3;A:0.2251,9.6199,-1.1444;G:-0.0112,0.0750,-0.0372;ID3;A:0.2346,9.6247,-1.0678;G:-0.0149,0.0819,-0.0442;ID3;A:0.1772,9.5720,-1.0295;G:-0.0128,0.0782,-0.0426;ID3;A:0.2059,9.5960,-1.0678;G:-0.0176,0.0819,-0.0447;ID3;A:0.2011,9.5912,-1.0487;G:-0.0133,0.0825,-0.0394;ID3;A:0.1628,9.6055,-1.0582;G:-0.0149,0.0750,-0.0388;ID3;A:0.1532,9.6151,-1.0678;G:-0.0133,0.0793,-0.0415;ID3;A:0.1724,9.6199,-1.0199;G:-0.0128,0.0803,-0.0404;ID3;A:0.2203,9.5912,-1.0582;G:-0.0133,0.0788,-0.0426;ID3;A:0.2155,9.6055,-1.0726;G:-0.0144,0.0803,-0.0415;ID3;A:0.1867,9.5672,-1.0726;G:-0.0149,0.0819,-0.0383;ID3;A:0.1676,9.5912,-1.0726;G:-0.0122,0.0745,-0.0431;ID3;A:0.2251,9.5672,-1.0487;G:-0.0186,0.0835,-0.0410;ID3;A:0.2107,9.6103,-1.0487;G:-0.0128,0.0825,-0.0415;ID3;A:0.1820,9.6199,-1.0295;G:-0.0144,0.0803,-0.0394;ID3;A:0.1867,9.6295,-1.1013;G:-0.0138,0.0803,-0.0447;ID3;A:0.1963,9.6103,-1.0247;G:-0.0128,0.0851,-0.0431;ID3;A:0.1867,9.5912,-1.0104;G:-0.0117,0.0788,-0.0436;ID3;A:0.1867,9.5912,-1.0822;G:-0.0133,0.0782,-0.0357;ID3;A:0.1437,9.6343,-1.1013;G:-0.0138,0.0788,-0.0404;ID3;A:0.1820,9.6103,-1.0295;G:-0.0128,0.0793,-0.0388;ID3;A:0.1772,9.5960,-1.0726;G:-0.0101,0.0766,-0.0399;ID3;A:0.1724,9.5816,-1.0726;G:-0.0122,0.0825,-0.0410;ID3;A:0.2251,9.6007,-1.0534;G:-0.0106,0.0803,-0.0447;ID3;A:0.2394,9.5816,-1.0487;G:-0.0117,0.0846,-0.0431;ID3;A:0.2059,9.6199,-1.0391;G:-0.0160,0.0761,-0.0399;ID3;A:0.1293,9.5577,-0.9960;G:-0.0122,0.0809,-0.0452;ID3;A:0.1676,9.5337,-1.0870;G:-0.0138,0.0857,-0.0431;ID3;A:0.2011,9.5720,-1.0534;G:-0.0112,0.0809,-0.0410;ID3;A:0.1915,9.6534,-1.0439;G:-0.0154,0.0793,-0.0431;ID3;A:0.1867,9.6438,-1.0582;G:-0.0138,0.0857,-0.0463;ID3;A:0.1676,9.6295,-1.0582;G:-0.0112,0.0819,-0.0415;ID3;A:0.1724,9.6247,-1.0918;G:-0.0144,0.0803,-0.0442;ID3;A:0.2059,9.5912,-1.0918;G:-0.0138,0.0734,-0.0394;ID3;A:0.1963,9.6295,-1.0774;G:-0.0149,0.0803,-0.0420;ID3;A:0.2059,9.6151,-1.0439;G:-0.0096,0.0857,-0.0415;ID3;A:0.1484,9.6295,-1.0965;G:-0.0138,0.0756,-0.0420;ID3;A:0.1915,9.6391,-1.0774;G:-0.0101,0.0803,-0.0415;ID3;A:0.1867,9.5864,-1.0965;G:-0.0133,0.0782,-0.0420;ID3;A:0.2203,9.6151,-1.1157;G:-0.0112,0.0793,-0.0447;ID3;A:0.2298,9.5146,-1.0391;G:-0.0096,0.0798,-0.0452;ID3;A:0.1628,9.5960,-1.0295;G:-0.0112,0.0819,-0.0436;ID3;A:0.1963,9.5720,-1.0726;G:-0.0122,0.0788,-0.0415;ID3;A:0.1915,9.5816,-1.1349;G:-0.0170,0.0814,-0.0468;ID3;A:0.1915,9.5672,-1.1061;G:-0.0192,0.0819,-0.0452;ID3;A:0.1963,9.6151,-1.0774;G:-0.0128,0.0841,-0.0431;ID3;A:0.1963,9.5864,-1.0343;G:-0.0133,0.0777,-0.0420;ID3;A:0.1628,9.5864,-1.0487;G:-0.0128,0.0772,-0.0426;ID3;A:0.1963,9.6151,-1.0678;G:-0.0149,0.0819,-0.0436;ID3;A:0.1963,9.6055,-1.0726;G:-0.0117,0.0798,-0.0447;ID3;A:0.1724,9.6199,-1.0391;G:-0.0101,0.0793,-0.0468;ID3;A:0.1724,9.6055,-1.0534;G:-0.0160,0.0819,-0.0442;ID3;A:0.1628,9.5864,-1.0726;G:-0.0154,0.0814,-0.0436;ID3;A:0.1915,9.6582,-1.1492;G:-0.0176,0.0825,-0.0415;ID3;A:0.1724,9.6007,-1.0487;G:-0.0133,0.0819,-0.0431;ID3;A:0.1867,9.5912,-1.0199;G:-0.0133,0.0756,-0.0410;ID3;A:0.2203,9.6438,-1.0439;G:-0.0128,0.0825,-0.0399;ID3;A:0.1676,9.5912,-1.0774;G:-0.0176,0.0803,-0.0415;ID3;A:0.2011,9.5912,-1.0343;G:-0.0170,0.0793,-0.0410;ID3;A:0.1867,9.5768,-1.0726;G:-0.0117,0.0803,-0.0410;End3;"
    #parsed = data_processor.parse_data(raw)
    #formated = data_processor.format_data(parsed)

    raw = "Start1;ID1;A:1.8106,7.6305,-6.4809;G:0.6444,-0.5901,0.5635;ID1;A:0.7616,6.9551,-6.9216;G:0.1751,-0.9434,0.1692;ID1;A:0.3928,6.7061,-6.5767;G:-0.1713,0.1979,-0.1485;ID1;A:0.7137,7.5395,-5.8199;G:-0.1953,-0.4182,-0.0724;ID1;A:0.1629,7.6449,-5.7145;G:-0.1783,0.0708,-0.0527;ID1;A:0.5461,7.4964,-6.0594;G:-0.0750,0.1352,-0.0170;ID1;A:0.3640,7.5683,-6.3037;G:-0.0644,0.0963,-0.0825;ID1;A:0.7329,7.3144,-6.1265;G:-0.0271,0.0633,-0.1724;ID1;A:-0.0575,7.8844,-5.9444;G:0.0644,0.0867,-0.0250;ID1;A:0.4359,7.4677,-5.9971;G:0.1868,0.0591,0.0149;ID1;A:0.6323,7.3910,-6.2462;G:0.0729,0.1298,-0.0463;ID1;A:0.6083,7.3910,-6.1073;G:0.0729,0.0937,-0.1245;ID1;A:0.5317,7.3527,-6.1552;G:0.0527,0.0580,-0.0798;ID1;A:0.3593,7.4341,-6.2127;G:0.0474,0.0676,-0.0905;ID1;A:0.1964,7.5156,-6.1552;G:0.0676,0.0942,-0.0607;ID1;A:0.2443,7.4868,-6.2271;G:0.0229,0.0458,0.0165;ID1;A:0.3401,7.4150,-6.2654;G:0.0351,0.0436,-0.0144;ID1;A:0.2491,7.4437,-6.1600;G:0.0905,0.0506,-0.0383;ID1;A:0.2251,7.4150,-6.3420;G:0.0878,0.0628,-0.0234;ID1;A:0.1964,7.4964,-6.3372;G:0.0436,0.0261,-0.0138;ID1;A:0.4694,7.4006,-6.2702;G:-0.0005,0.0277,-0.0500;ID1;A:0.2587,7.4437,-6.1360;G:0.0250,0.0388,-0.0452;ID1;A:0.3497,7.3000,-6.2175;G:0.0484,0.0463,-0.0458;ID1;A:0.2443,7.3575,-6.2989;G:0.0809,0.0319,0.0117;ID1;A:0.3305,7.3671,-6.3468;G:0.0367,0.0617,0.0043;ID1;A:0.1868,7.4437,-6.2702;G:0.0346,0.0106,-0.0218;ID1;A:0.4455,7.2569,-6.2893;G:0.0186,0.0378,-0.0431;ID1;A:0.4455,7.4150,-6.1456;G:0.0234,0.0905,-0.0681;ID1;A:0.2874,7.3671,-6.3276;G:0.0415,0.0521,-0.0037;ID1;A:0.2108,7.4725,-6.2414;G:-0.0144,0.0287,-0.0154;ID1;A:0.3114,7.4725,-6.2271;G:0.0128,0.0410,0.0112;ID1;A:0.3593,7.4102,-6.1360;G:-0.0165,-0.0484,0.0921;ID1;A:0.2395,7.5539,-6.2510;G:0.0303,0.0271,0.0532;ID1;A:0.3880,7.4677,-6.0163;G:0.0176,0.0937,0.0059;ID1;A:0.2299,7.5299,-6.2175;G:0.0341,0.0798,-0.0085;ID1;A:0.3018,7.6257,-6.0594;G:-0.0314,0.0878,-0.0436;ID1;A:0.2299,7.6928,-5.9396;G:-0.1022,0.0750,-0.0617;ID1;A:0.3688,7.6689,-5.7720;G:-0.0798,0.1490,-0.0841;End1;Start2;ID2;A:0.1867,9.5768,-0.5555;G:-0.0144,0.0064,-0.0186;ID2;A:0.2298,9.5433,-0.6177;G:-0.0165,0.0053,-0.0192;ID2;A:0.1963,9.5768,-0.5938;G:-0.0133,0.0064,-0.0170;ID2;A:0.2203,9.5577,-0.5124;G:-0.0154,0.0064,-0.0202;ID2;A:0.2203,9.5672,-0.5938;G:-0.0149,0.0053,-0.0208;ID2;A:0.1820,9.6151,-0.5746;G:-0.0170,0.0048,-0.0239;ID2;A:0.2586,9.6199,-0.5938;G:-0.0122,0.0085,-0.0229;ID2;A:0.1532,9.5816,-0.5842;G:-0.0160,0.0064,-0.0197;ID2;A:0.2251,9.6055,-0.5938;G:-0.0144,0.0085,-0.0208;ID2;A:0.2251,9.5816,-0.5363;G:-0.0170,0.0032,-0.0170;ID2;A:0.2251,9.5720,-0.5938;G:-0.0154,0.0080,-0.0176;ID2;A:0.1676,9.5481,-0.5698;G:-0.0181,0.0080,-0.0239;ID2;A:0.2155,9.5720,-0.5602;G:-0.0144,0.0053,-0.0192;ID2;A:0.2011,9.5912,-0.6225;G:-0.0144,0.0085,-0.0213;ID2;A:0.2107,9.5960,-0.6129;G:-0.0149,0.0096,-0.0181;ID2;A:0.2107,9.5385,-0.5555;G:-0.0154,0.0048,-0.0223;ID2;A:0.1676,9.5720,-0.5650;G:-0.0154,0.0064,-0.0223;ID2;A:0.2107,9.5864,-0.5890;G:-0.0160,0.0080,-0.0197;ID2;A:0.1963,9.5816,-0.5555;G:-0.0117,0.0069,-0.0181;ID2;A:0.2203,9.6055,-0.6033;G:-0.0149,0.0064,-0.0218;ID2;A:0.2107,9.5624,-0.6129;G:-0.0154,0.0090,-0.0176;ID2;A:0.2107,9.5816,-0.5794;G:-0.0186,0.0032,-0.0170;ID2;A:0.2155,9.5433,-0.6129;G:-0.0181,0.0053,-0.0176;ID2;A:0.2298,9.5481,-0.5124;G:-0.0117,0.0074,-0.0192;ID2;A:0.1820,9.5960,-0.5411;G:-0.0165,0.0080,-0.0181;ID2;A:0.2155,9.5864,-0.5171;G:-0.0096,0.0090,-0.0234;ID2;A:0.1724,9.5960,-0.5459;G:-0.0181,0.0059,-0.0122;ID2;A:0.2107,9.5816,-0.5267;G:-0.0170,0.0080,-0.0223;ID2;A:0.2155,9.6007,-0.5794;G:-0.0144,0.0080,-0.0234;ID2;A:0.2011,9.5672,-0.5938;G:-0.0133,0.0053,-0.0170;ID2;A:0.1963,9.5624,-0.5890;G:-0.0138,0.0074,-0.0218;ID2;A:0.1820,9.6247,-0.5219;G:-0.0160,0.0064,-0.0186;ID2;A:0.1963,9.5577,-0.5794;G:-0.0122,0.0122,-0.0202;ID2;A:0.2011,9.5624,-0.6177;G:-0.0181,0.0064,-0.0229;ID2;A:0.2059,9.5624,-0.5746;G:-0.0122,0.0090,-0.0266;ID2;A:0.2298,9.5768,-0.5890;G:-0.0112,0.0090,-0.0202;ID2;A:0.2059,9.5577,-0.5794;G:-0.0138,0.0080,-0.0186;ID2;A:0.2298,9.5816,-0.5986;G:-0.0170,0.0080,-0.0239;ID2;A:0.2011,9.5864,-0.5171;G:-0.0170,0.0080,-0.0229;ID2;A:0.1963,9.5577,-0.5650;G:-0.0208,0.0048,-0.0197;ID2;A:0.2059,9.5577,-0.5602;G:-0.0160,0.0080,-0.0186;ID2;A:0.2298,9.5672,-0.5411;G:-0.0160,0.0043,-0.0186;ID2;A:0.1915,9.6151,-0.5219;G:-0.0122,0.0085,-0.0192;ID2;A:0.2011,9.5768,-0.5363;G:-0.0117,0.0101,-0.0197;ID2;A:0.2059,9.5816,-0.5890;G:-0.0165,0.0090,-0.0229;ID2;A:0.1963,9.5672,-0.5938;G:-0.0176,0.0064,-0.0218;ID2;A:0.2011,9.5672,-0.5890;G:-0.0170,0.0064,-0.0271;ID2;A:0.2155,9.5624,-0.5890;G:-0.0138,0.0027,-0.0144;ID2;A:0.1963,9.6055,-0.5555;G:-0.0122,0.0074,-0.0186;ID2;A:0.2298,9.5672,-0.5986;G:-0.0176,0.0064,-0.0218;ID2;A:0.1963,9.5960,-0.5267;G:-0.0160,0.0074,-0.0176;ID2;A:0.2011,9.5768,-0.5602;G:-0.0149,0.0090,-0.0255;ID2;A:0.2203,9.5385,-0.5124;G:-0.0154,0.0085,-0.0186;ID2;A:0.1820,9.5816,-0.5650;G:-0.0138,0.0085,-0.0239;ID2;A:0.1820,9.5289,-0.5938;G:-0.0160,0.0059,-0.0208;ID2;A:0.2251,9.5768,-0.6704;G:-0.0112,0.0053,-0.0197;ID2;A:0.2011,9.5864,-0.5794;G:-0.0128,0.0059,-0.0218;ID2;A:0.1963,9.5864,-0.5698;G:-0.0170,0.0112,-0.0245;ID2;A:0.1963,9.5289,-0.5555;G:-0.0112,0.0069,-0.0208;ID2;A:0.2538,9.5529,-0.4980;G:-0.0192,0.0085,-0.0192;Start3;ID3;A:0.0862,9.6247,-1.1875;G:-0.0122,0.0835,-0.0442;ID3;A:0.1006,9.6103,-1.2258;G:-0.0149,0.0782,-0.0474;ID3;A:0.0814,9.6007,-1.2115;G:-0.0149,0.0835,-0.0458;ID3;A:0.0622,9.6199,-1.2306;G:-0.0117,0.0788,-0.0474;ID3;A:0.1101,9.6534,-1.1971;G:-0.0096,0.0798,-0.0442;ID3;A:0.0766,9.6295,-1.1732;G:-0.0149,0.0814,-0.0415;ID3;A:0.0814,9.6247,-1.2498;G:-0.0154,0.0782,-0.0436;ID3;A:0.0670,9.6199,-1.2402;G:-0.0165,0.0793,-0.0458;ID3;A:0.1053,9.6151,-1.2306;G:-0.0149,0.0819,-0.0447;ID3;A:0.0670,9.6247,-1.2306;G:-0.0133,0.0766,-0.0458;ID3;A:0.1053,9.6534,-1.1588;G:-0.0149,0.0772,-0.0452;ID3;A:0.1006,9.6582,-1.1875;G:-0.0133,0.0798,-0.0458;ID3;A:0.0814,9.6295,-1.2115;G:-0.0117,0.0835,-0.0479;ID3;A:0.0862,9.6199,-1.1540;G:-0.0133,0.0772,-0.0442;ID3;A:0.1006,9.5816,-1.2450;G:-0.0154,0.0788,-0.0447;ID3;A:0.0622,9.6007,-1.1779;G:-0.0144,0.0803,-0.0463;ID3;A:0.0910,9.5912,-1.1396;G:-0.0149,0.0756,-0.0468;ID3;A:0.0910,9.6151,-1.2067;G:-0.0122,0.0793,-0.0426;ID3;A:0.1006,9.6247,-1.2067;G:-0.0112,0.0809,-0.0495;ID3;A:0.0718,9.6343,-1.2067;G:-0.0128,0.0841,-0.0468;ID3;A:0.0766,9.6295,-1.2115;G:-0.0176,0.0814,-0.0436;ID3;A:0.0958,9.6534,-1.1684;G:-0.0154,0.0825,-0.0463;ID3;A:0.0814,9.5960,-1.1923;G:-0.0160,0.0761,-0.0436;ID3;A:0.0814,9.6007,-1.2115;G:-0.0133,0.0809,-0.0490;ID3;A:0.0718,9.6247,-1.2402;G:-0.0112,0.0819,-0.0436;ID3;A:0.0527,9.6343,-1.1779;G:-0.0133,0.0793,-0.0420;ID3;A:0.0622,9.6103,-1.2019;G:-0.0160,0.0788,-0.0415;ID3;A:0.0575,9.6151,-1.2641;G:-0.0133,0.0793,-0.0484;ID3;A:0.1149,9.6438,-1.1923;G:-0.0112,0.0825,-0.0436;ID3;A:0.0383,9.6391,-1.2210;G:-0.0096,0.0772,-0.0463;ID3;A:0.0622,9.6295,-1.2019;G:-0.0160,0.0766,-0.0415;ID3;A:0.0862,9.6247,-1.1875;G:-0.0101,0.0803,-0.0511;ID3;A:0.0575,9.6103,-1.1971;G:-0.0122,0.0803,-0.0447;ID3;A:0.0910,9.6582,-1.1971;G:-0.0128,0.0814,-0.0452;ID3;A:0.1006,9.6391,-1.1779;G:-0.0122,0.0819,-0.0447;ID3;A:0.0479,9.6486,-1.2210;G:-0.0112,0.0777,-0.0383;ID3;A:0.0718,9.6247,-1.1444;G:-0.0122,0.0835,-0.0479;ID3;A:0.1053,9.6151,-1.1923;G:-0.0160,0.0788,-0.0431;ID3;A:0.0383,9.6055,-1.1684;G:-0.0128,0.0793,-0.0479;ID3;A:0.0622,9.6199,-1.2067;G:-0.0149,0.0793,-0.0447;Start4;ID4;A:-0.0431,9.7252,-1.5275;G:-0.0468,0.0468,-0.0176;ID4;A:0.0096,9.7157,-1.4940;G:-0.0468,0.0463,-0.0186;ID4;A:-0.0239,9.7444,-1.5371;G:-0.0452,0.0474,-0.0165;ID4;A:-0.0718,9.7492,-1.5227;G:-0.0447,0.0458,-0.0197;ID4;A:0.0287,9.7205,-1.4605;G:-0.0463,0.0458,-0.0208;ID4;A:-0.0096,9.7157,-1.5227;G:-0.0468,0.0420,-0.0149;ID4;A:-0.0287,9.7061,-1.4988;G:-0.0463,0.0468,-0.0160;ID4;A:-0.0096,9.7348,-1.4605;G:-0.0463,0.0452,-0.0186;ID4;A:-0.0096,9.7157,-1.5227;G:-0.0452,0.0426,-0.0229;ID4;A:0.0144,9.7348,-1.4700;G:-0.0484,0.0495,-0.0181;ID4;A:-0.0144,9.6965,-1.4892;G:-0.0452,0.0452,-0.0176;ID4;A:-0.0048,9.7540,-1.5610;G:-0.0490,0.0452,-0.0165;ID4;A:-0.0096,9.7252,-1.4844;G:-0.0474,0.0447,-0.0176;ID4;A:0.0000,9.7300,-1.5658;G:-0.0442,0.0436,-0.0181;ID4;A:-0.0144,9.7731,-1.4940;G:-0.0431,0.0463,-0.0192;ID4;A:-0.0096,9.6965,-1.5323;G:-0.0436,0.0490,-0.0192;ID4;A:0.0000,9.7348,-1.5131;G:-0.0452,0.0452,-0.0213;ID4;A:-0.0048,9.7109,-1.5467;G:-0.0426,0.0458,-0.0176;ID4;A:-0.0431,9.7157,-1.4892;G:-0.0463,0.0431,-0.0192;ID4;A:-0.0383,9.6965,-1.4557;G:-0.0527,0.0431,-0.0229;ID4;A:0.0239,9.7157,-1.5227;G:-0.0490,0.0458,-0.0181;ID4;A:-0.0622,9.6869,-1.5419;G:-0.0463,0.0442,-0.0181;ID4;A:-0.0144,9.7205,-1.5802;G:-0.0463,0.0426,-0.0176;ID4;A:-0.0144,9.7300,-1.4988;G:-0.0463,0.0436,-0.0213;ID4;A:0.0192,9.7396,-1.4940;G:-0.0452,0.0463,-0.0239;ID4;A:-0.0335,9.7492,-1.5179;G:-0.0484,0.0431,-0.0218;ID4;A:-0.0287,9.6869,-1.5514;G:-0.0447,0.0426,-0.0176;ID4;A:0.0335,9.7205,-1.5514;G:-0.0495,0.0431,-0.0192;ID4;A:-0.0192,9.7109,-1.5514;G:-0.0458,0.0431,-0.0165;ID4;A:-0.0527,9.7205,-1.4365;G:-0.0474,0.0447,-0.0165;ID4;A:-0.0527,9.7348,-1.5658;G:-0.0452,0.0484,-0.0223;ID4;A:-0.0287,9.7252,-1.5036;G:-0.0436,0.0404,-0.0197;ID4;A:0.0048,9.7205,-1.5275;G:-0.0452,0.0442,-0.0218;ID4;A:0.0192,9.7252,-1.5323;G:-0.0479,0.0468,-0.0186;ID4;A:-0.0144,9.7013,-1.4892;G:-0.0500,0.0436,-0.0160;ID4;A:0.0383,9.6917,-1.4988;G:-0.0436,0.0431,-0.0165;ID4;A:0.0048,9.7348,-1.5275;G:-0.0479,0.0463,-0.0170;ID4;A:-0.0335,9.7013,-1.4222;G:-0.0474,0.0474,-0.0165;ID4;A:-0.0048,9.7588,-1.5419;G:-0.0490,0.0436,-0.0208;ID4;A:-0.0192,9.7444,-1.5419;G:-0.0436,0.0426,-0.0192;"
    correct = data_processor.correct_data(raw)
    parsed = data_processor.parse_data(correct)
    formatted = data_processor.format_data(parsed)


def correct_data(raw):
    """
    Analizza una stringa di dati da sensori e aggiunge i tag 'End' mancanti.

    Args:
        dati_grezzi: La stringa di dati non elaborata, con elementi separati da ';'.

    Returns:
        Una stringa di dati corretta con tutti i blocchi
        opportunamente chiusi da un tag End<N>.
    """
    components = [part for part in raw.split(';') if part]
    if not components:
        return ""
    correct_parts = []
    id = None
    for comp in components:
        if comp.startswith('Start'):
            if id is not None:
                correct_parts.append(f"End{id}")
            match = re.search(r'\d+', comp)
            if match:
                id = match.group(0)
            correct_parts.append(comp)
        elif comp.startswith('End'):
            correct_parts.append(comp)
            id = None
        else:
            correct_parts.append(comp)
    if id is not None:
        correct_parts.append(f"End{id}")

    return ';'.join(correct_parts)

def correct_sensor_data(data_string, num_sensors):
    """
    Corregge i dati dei sensori aggiungendo i marcatori 'Startn;' e 'Endn;' mancanti.

    Args:
        data_string (str): La stringa contenente i dati dei sensori.
        num_sensors (int): Il numero totale di sensori attesi.

    Returns:
        str: La stringa con i dati dei sensori corretti e i marcatori aggiunti.
    """
    corrected_lines = []
    lines = data_string.split(';')
    # Remove any empty strings from splitting, which can happen if data_string ends with ';'
    lines = [line.strip() for line in lines if line.strip()]

    current_sensor_id = None
    expected_next_sensor_id = 1

    for line in lines:
        if line.startswith("Start"):
            try:
                # Extract sensor ID from the Start marker
                actual_sensor_id = int(line[5])
                if actual_sensor_id != expected_next_sensor_id:
                    # If we found a Start marker for a sensor out of order,
                    # it means the previous End marker was missing.
                    # We also need to add missing Start markers for intermediate sensors.
                    while expected_next_sensor_id < actual_sensor_id:
                        corrected_lines.append(f"Start{expected_next_sensor_id};")
                        corrected_lines.append(f"End{expected_next_sensor_id};")
                        expected_next_sensor_id += 1
                    
                    # Now add the current Start marker
                    corrected_lines.append(line + ";")
                    current_sensor_id = actual_sensor_id
                    expected_next_sensor_id = actual_sensor_id + 1
                else:
                    # Correct Start marker found, proceed
                    corrected_lines.append(line + ";")
                    current_sensor_id = actual_sensor_id
                    expected_next_sensor_id = actual_sensor_id + 1
            except (ValueError, IndexError):
                # Malformed Start marker, treat as data and handle later if needed
                corrected_lines.append(line + ";")
        elif line.startswith("End"):
            try:
                # Extract sensor ID from the End marker
                actual_sensor_id = int(line[3])
                if current_sensor_id is not None and actual_sensor_id == current_sensor_id:
                    corrected_lines.append(line + ";")
                    current_sensor_id = None  # Reset as the block has ended
                else:
                    # End marker found but doesn't match current_sensor_id or no current sensor,
                    # could mean a missing Start. For now, just append.
                    # More robust error handling could be added here.
                    corrected_lines.append(line + ";")
            except (ValueError, IndexError):
                corrected_lines.append(line + ";")
        elif line.startswith("ID"):
            # This is a data line. Check if we're currently inside a sensor block.
            try:
                data_sensor_id = int(line[2])
                if current_sensor_id is None:
                    # If we encounter an ID line without a preceding Start,
                    # it means the Start marker was missing.
                    # We also need to add missing Start/End markers for previous sensors.
                    while expected_next_sensor_id < data_sensor_id:
                        corrected_lines.append(f"Start{expected_next_sensor_id};")
                        corrected_lines.append(f"End{expected_next_sensor_id};")
                        expected_next_sensor_id += 1
                    
                    corrected_lines.append(f"Start{data_sensor_id};")
                    current_sensor_id = data_sensor_id
                    expected_next_sensor_id = data_sensor_id + 1
                elif data_sensor_id != current_sensor_id:
                    # We've transitioned to a new sensor ID without an End marker.
                    # Add the missing End marker for the previous sensor.
                    corrected_lines.append(f"End{current_sensor_id};")
                    # Then add the Start marker for the new sensor.
                    # And handle any missing intermediate Start/End markers.
                    while expected_next_sensor_id < data_sensor_id:
                        corrected_lines.append(f"Start{expected_next_sensor_id};")
                        corrected_lines.append(f"End{expected_next_sensor_id};")
                        expected_next_sensor_id += 1

                    corrected_lines.append(f"Start{data_sensor_id};")
                    current_sensor_id = data_sensor_id
                    expected_next_sensor_id = data_sensor_id + 1
                
                corrected_lines.append(line + ";") # Append the data line itself
            except (ValueError, IndexError):
                # Malformed ID line, just append it
                corrected_lines.append(line + ";")
        else:
            # Not a recognized marker or ID, just append it
            corrected_lines.append(line + ";")

    # After processing all lines, check if any sensor blocks were left open
    if current_sensor_id is not None:
        corrected_lines.append(f"End{current_sensor_id};")
        expected_next_sensor_id = current_sensor_id + 1 # Update for the last sensor

    # Ensure all expected sensor blocks have Start/End markers
    while expected_next_sensor_id <= num_sensors:
        corrected_lines.append(f"Start{expected_next_sensor_id};")
        corrected_lines.append(f"End{expected_next_sensor_id};")
        expected_next_sensor_id += 1

    return "".join(corrected_lines)

raw = "Start1;ID1;A:-3.3291,6.8833,-6.1600;G:0.2373,0.0841,0.2772;ID1;A:-3.0944,6.8977,-6.3564;G:0.1208,0.1809,0.1203;ID1;A:-3.2620,7.7215,-7.5683;G:-0.5108,-0.7630,0.5843;ID1;A:-2.6297,6.4713,-4.7852;G:-1.1265,-1.3005,1.0898;ID1;A:-3.3003,7.9898,-5.9444;G:-0.1144,0.0229,-0.1219;ID1;A:-2.7399,7.3623,-5.8343;G:0.0607,-0.0532,-0.1596;ID1;A:-3.0848,7.4437,-5.6858;G:-0.1469,0.0154,-0.0835;ID1;A:-2.7495,7.4150,-5.5181;G:-0.2395,0.0330,-0.1346;ID1;A:-2.7351,7.4773,-5.1685;G:-0.0521,0.0729,0.0197;ID1;A:-2.9171,7.4629,-5.7193;G:0.0266,0.0713,-0.0724;ID1;A:-2.9507,7.3335,-5.5660;G:0.1096,0.0692,-0.0112;ID1;A:-2.6824,7.3288,-5.5756;G:0.0325,0.0857,0.0410;ID1;A:-2.7255,7.5443,-5.5277;G:0.0197,0.0623,-0.0639;ID1;A:-2.9650,7.4246,-5.4559;G:0.0133,-0.0090,-0.0234;ID1;A:-2.7734,7.4150,-5.5373;G:-0.0059,0.0463,-0.0639;ID1;A:-2.4669,7.2761,-5.6331;G:-0.0607,0.0282,-0.0532;ID1;A:-3.2093,7.5587,-5.3313;G:-0.0516,0.0186,-0.0883;ID1;A:-2.9219,7.4341,-5.4798;G:0.0208,0.0639,-0.0745;ID1;A:-3.3099,7.5683,-5.4271;G:0.0314,0.0830,-0.0644;ID1;A:-3.0608,7.4868,-5.4511;G:0.0766,0.0149,0.0128;ID1;A:-3.5350,7.5683,-4.9242;G:-0.0287,0.0223,-0.0298;ID1;A:-2.6202,7.3048,-5.8103;G:0.1048,-0.0037,0.0681;ID1;A:-3.0800,7.5108,-5.1972;G:0.0303,-0.0245,-0.0106;ID1;A:-2.9123,7.3671,-5.4750;G:0.0266,0.0319,-0.0218;ID1;A:-2.9986,7.4677,-5.6379;G:0.0011,0.0516,-0.0639;ID1;A:-3.0800,7.4581,-5.5421;G:-0.0096,0.1048,-0.0846;ID1;A:-3.0608,7.4725,-5.6091;G:-0.0383,0.2192,-0.1703;ID1;A:-2.9315,7.5731,-5.0918;G:0.0580,0.2070,-0.1453;ID1;A:-3.1566,7.2904,-5.6906;G:0.0553,0.0298,-0.0165;ID1;A:-3.2141,7.4677,-5.4367;G:0.0112,0.0362,-0.0367;ID1;A:-2.9938,7.4006,-5.5564;G:0.0607,0.0500,-0.0170;ID1;A:-3.0704,7.4150,-5.4127;G:0.0527,0.0266,0.0053;ID1;A:-3.0896,7.3719,-5.4942;G:0.0585,0.0080,0.0468;ID1;A:-2.7926,7.3288,-5.5517;G:0.0410,0.0176,0.0069;ID1;A:-3.1614,7.4820,-5.2595;G:0.0106,-0.0223,0.0351;ID1;A:-2.9123,7.3288,-5.5756;G:0.0851,0.0053,0.0394;ID1;A:-3.0896,7.4581,-5.3840;G:0.0112,0.0287,0.0037;ID1;A:-3.0369,7.4294,-5.4654;G:0.0426,0.0330,-0.0133;ID1;A:-3.0656,7.4006,-5.5181;G:0.0575,0.0309,0.0027;ID1;A:-2.9986,7.3958,-5.4702;G:0.0298,0.0420,-0.0021;ID1;A:-2.9602,7.3910,-5.4750;G:0.0506,0.0202,0.0021;ID1;A:-3.0752,7.4102,-5.4798;G:0.0378,0.0165,0.0021;ID1;A:-3.0656,7.4006,-5.5133;G:0.0569,0.0303,0.0154;ID1;A:-2.9938,7.3910,-5.5421;G:0.0431,0.0325,-0.0085;ID1;A:-2.9938,7.4150,-5.5517;G:0.0362,0.0245,-0.0096;ID1;A:-3.0225,7.3958,-5.5852;G:0.0495,0.0122,-0.0005;ID1;A:-3.0225,7.4198,-5.5612;G:0.0314,0.0170,0.0074;ID1;A:-2.9890,7.3479,-5.4750;G:0.0553,0.0266,0.0266;ID1;A:-2.9890,7.3815,-5.5133;G:0.0607,0.0330,-0.0112;ID1;A:-3.1423,7.3910,-5.5612;G:0.0351,0.0037,-0.0027;ID1;A:-3.1135,7.4006,-5.4415;G:0.0788,-0.0085,0.0309;ID1;A:-2.9650,7.2713,-5.5564;G:0.0436,0.0250,-0.0170;ID1;A:-2.9842,7.2856,-5.5373;G:0.0404,0.0341,0.0005;ID1;A:-3.0560,7.3383,-5.4942;G:0.0229,0.0314,-0.0138;ID1;A:-3.1375,7.3479,-5.5469;G:0.0479,0.0325,0.0043;ID1;A:-3.0465,7.3192,-5.5517;G:0.0388,0.0452,-0.0011;ID1;A:-3.0608,7.3575,-5.4942;G:0.0484,0.0255,0.0122;ID1;A:-3.0321,7.3383,-5.7289;G:0.0383,0.0309,0.0117;ID1;A:-3.1135,7.4054,-5.5229;G:0.0271,0.0330,-0.0170;ID1;A:-3.0129,7.2952,-5.5900;G:0.0894,0.0952,0.0170;ID1;A:-3.0177,7.2952,-5.7337;G:0.0261,0.1341,0.0080;ID1;A:-3.3818,7.4677,-5.8917;G:0.2320,0.3129,0.0660;ID1;A:-2.9028,7.5683,-5.7672;G:0.1378,0.4007,0.1868;ID1;A:-3.0992,7.8796,-5.9253;G:0.2591,0.0729,0.6220;ID1;A:-2.9363,7.2425,-7.3144;G:0.1554,0.2703,-0.0803;ID1;A:-2.5866,7.0749,-6.4187;G:0.0277,0.0080,0.0160;ID1;A:-2.2226,6.7204,-6.2462;G:-0.0724,0.0277,-0.0282;ID1;A:-2.6249,7.1324,-6.1217;G:-0.0692,-0.0362,0.0011;ID1;A:-2.5723,6.8833,-6.2606;G:-0.1187,-0.0341,-0.0458;ID1;A:-2.4477,7.0653,-5.8678;G:-0.3427,-0.1745,-0.0814;ID1;A:-3.2141,7.7503,-5.4271;G:-0.3900,-0.1341,-0.0500;ID1;A:-2.9507,7.7311,-4.9769;G:0.0160,0.0426,0.2097;ID1;A:-2.4717,7.4006,-5.1301;G:0.7482,0.4119,0.4044;ID1;A:-2.3232,7.3240,-6.2989;G:0.4385,0.0543,0.1394;ID1;A:-1.6334,6.7252,-6.3612;G:0.1038,0.1011,0.0543;ID1;A:-2.1124,7.1132,-6.0498;G:-0.0463,-0.0633,0.0564;ID1;A:-2.3663,7.5347,-5.9205;G:-0.1176,-0.0676,0.0181;ID1;A:-2.4429,7.4246,-5.8343;G:0.1256,0.0399,0.0165;ID1;A:-2.0645,7.1419,-6.0307;G:0.0724,0.0772,-0.0059;ID1;A:-2.4333,7.2042,-6.0594;G:0.0846,0.0122,-0.0005;ID1;A:-2.2226,7.0653,-5.9971;G:0.0367,0.0293,-0.0229;ID1;A:-2.3902,7.2665,-6.0594;G:0.0506,0.0628,-0.0027;ID1;A:-2.5004,7.4294,-6.2893;G:0.0005,-0.0011,0.0059;ID1;A:-2.2226,7.0701,-5.8630;G:0.0112,0.0032,-0.0303;ID1;A:-2.3375,7.2282,-6.1073;G:0.0000,0.0314,-0.0261;ID1;A:-2.1986,7.1324,-6.2414;G:-0.0069,0.0968,-0.0165;ID1;A:-2.2274,7.1084,-6.3516;G:-0.1282,0.1235,0.0277;ID1;A:-3.1183,8.1718,-5.7097;G:-0.1011,0.5726,0.1181;ID1;A:-2.9219,8.5742,-8.1910;G:0.0734,0.5917,0.6428;End1;ID2;A:0.1963,9.5768,-0.3591;G:-0.0186,0.0117,-0.0197;ID2;A:0.2155,9.5624,-0.3926;G:-0.0138,0.0090,-0.0208;ID2;A:0.2682,9.5577,-0.3543;G:-0.0133,0.0138,-0.0197;ID2;A:0.2394,9.5768,-0.4549;G:-0.0160,0.0117,-0.0192;ID2;A:0.2442,9.5672,-0.3926;G:-0.0133,0.0106,-0.0234;ID2;A:0.2203,9.5816,-0.4118;G:-0.0149,0.0085,-0.0181;ID2;A:0.2442,9.5529,-0.4070;G:-0.0165,0.0101,-0.0202;ID2;A:0.2155,9.5529,-0.4310;G:-0.0149,0.0144,-0.0202;ID2;A:0.2538,9.5624,-0.4453;G:-0.0128,0.0106,-0.0218;ID2;A:0.2298,9.5720,-0.4549;G:-0.0176,0.0069,-0.0197;ID2;A:0.2634,9.5816,-0.4310;G:-0.0138,0.0106,-0.0218;ID2;A:0.2586,9.5768,-0.4166;G:-0.0165,0.0096,-0.0223;ID2;A:0.2298,9.5529,-0.3783;G:-0.0133,0.0117,-0.0213;ID2;A:0.2251,9.5337,-0.4741;G:-0.0122,0.0074,-0.0208;ID2;A:0.2729,9.5960,-0.4453;G:-0.0170,0.0133,-0.0239;ID2;A:0.2346,9.5433,-0.4262;G:-0.0154,0.0106,-0.0208;ID2;A:0.2490,9.5624,-0.3496;G:-0.0160,0.0122,-0.0234;ID2;A:0.2251,9.6247,-0.4262;G:-0.0170,0.0064,-0.0239;ID2;A:0.2394,9.5912,-0.3304;G:-0.0106,0.0090,-0.0176;ID2;A:0.2011,9.5912,-0.4214;G:-0.0154,0.0106,-0.0213;ID2;A:0.2155,9.5720,-0.4453;G:-0.0170,0.0112,-0.0213;ID2;A:0.2059,9.5433,-0.4166;G:-0.0160,0.0133,-0.0202;ID2;A:0.2107,9.5960,-0.4262;G:-0.0122,0.0106,-0.0202;ID2;A:0.2586,9.5816,-0.3974;G:-0.0170,0.0106,-0.0213;ID2;A:0.2490,9.5433,-0.4118;G:-0.0144,0.0122,-0.0229;ID2;A:0.2251,9.5385,-0.5363;G:-0.0181,0.0069,-0.0197;ID2;A:0.1437,9.6055,-0.4166;G:-0.0186,0.0080,-0.0144;ID2;A:-0.0287,9.5672,-0.3496;G:-0.0053,0.0138,-0.0218;ID2;A:0.2442,9.5864,-0.2969;G:-0.0101,0.0096,-0.0255;ID2;A:0.1772,9.6965,-0.4166;G:-0.0160,0.0133,-0.0218;ID2;A:0.3926,9.5385,-0.4310;G:-0.0192,0.0133,-0.0245;ID2;A:0.3065,9.6103,-0.4693;G:-0.0170,0.0080,-0.0192;ID2;A:0.2538,9.5481,-0.5028;G:-0.0149,0.0064,-0.0234;ID2;A:0.2729,9.5481,-0.4405;G:-0.0149,0.0096,-0.0202;ID2;A:0.2490,9.5193,-0.4357;G:-0.0138,0.0090,-0.0176;ID2;A:0.2538,9.4523,-0.4980;G:-0.0181,0.0069,-0.0239;ID2;A:0.2969,9.5337,-0.5171;G:-0.0154,0.0043,-0.0234;ID2;A:0.2155,9.5146,-0.4070;G:-0.0170,0.0101,-0.0218;ID2;A:0.1772,9.5624,-0.3639;G:-0.0101,0.0080,-0.0261;ID2;A:0.2251,9.5577,-0.3926;G:-0.0117,0.0096,-0.0170;ID2;A:0.2682,9.5529,-0.3448;G:-0.0170,0.0080,-0.0223;ID2;A:0.2298,9.5241,-0.4453;G:-0.0133,0.0096,-0.0218;ID2;A:0.2107,9.5624,-0.3783;G:-0.0138,0.0069,-0.0170;ID2;A:0.2682,9.5672,-0.4453;G:-0.0160,0.0106,-0.0160;ID2;A:0.2298,9.5720,-0.3926;G:-0.0149,0.0122,-0.0202;ID2;A:0.2251,9.5385,-0.3783;G:-0.0133,0.0133,-0.0229;ID2;A:0.1772,9.5672,-0.6129;G:-0.0165,0.0133,-0.0149;ID2;A:0.2442,9.5672,-0.4118;G:-0.0149,0.0112,-0.0181;ID2;A:0.2825,9.5864,-0.4022;G:-0.0165,0.0128,-0.0223;ID2;A:0.2490,9.5768,-0.4166;G:-0.0138,0.0101,-0.0160;ID2;A:0.2394,9.5816,-0.3831;G:-0.0128,0.0085,-0.0186;ID2;A:0.2490,9.5672,-0.4166;G:-0.0128,0.0096,-0.0218;ID2;A:0.2155,9.5720,-0.4022;G:-0.0160,0.0085,-0.0229;ID2;A:0.2442,9.5385,-0.3448;G:-0.0181,0.0085,-0.0202;ID2;A:0.1867,9.5241,-0.4453;G:-0.0144,0.0117,-0.0192;ID2;A:0.1867,9.5912,-0.3687;G:-0.0128,0.0106,-0.0239;ID2;A:0.2538,9.5912,-0.3879;G:-0.0149,0.0122,-0.0197;ID2;A:0.2394,9.5816,-0.4022;G:-0.0128,0.0090,-0.0202;ID2;A:0.2490,9.5720,-0.4022;G:-0.0170,0.0112,-0.0197;ID2;A:0.2346,9.5624,-0.4070;G:-0.0165,0.0080,-0.0197;ID2;A:0.1963,9.6103,-0.4788;G:-0.0154,0.0122,-0.0223;ID2;A:0.2490,9.5385,-0.4166;G:-0.0160,0.0090,-0.0192;ID2;A:0.2634,9.5672,-0.3400;G:-0.0138,0.0112,-0.0213;ID2;A:0.2394,9.6103,-0.3783;G:-0.0160,0.0122,-0.0202;ID2;A:0.2251,9.5481,-0.4262;G:-0.0144,0.0069,-0.0213;ID2;A:0.2346,9.5624,-0.3879;G:-0.0144,0.0090,-0.0192;ID2;A:0.2586,9.5816,-0.3926;G:-0.0138,0.0101,-0.0176;ID2;A:0.2155,9.5529,-0.3926;G:-0.0138,0.0069,-0.0202;ID2;A:0.2394,9.5960,-0.4214;G:-0.0128,0.0106,-0.0234;ID2;A:0.2203,9.5577,-0.3735;G:-0.0170,0.0080,-0.0202;ID2;A:0.2634,9.5720,-0.3352;G:-0.0144,0.0080,-0.0223;ID2;A:0.2394,9.5624,-0.4118;G:-0.0186,0.0043,-0.0186;ID2;A:0.2298,9.5864,-0.3783;G:-0.0138,0.0101,-0.0208;ID2;A:0.1963,9.5960,-0.4214;G:-0.0154,0.0122,-0.0223;ID2;A:0.2107,9.5912,-0.4453;G:-0.0186,0.0074,-0.0192;ID2;A:0.2538,9.5912,-0.3974;G:-0.0128,0.0090,-0.0234;ID2;A:0.2346,9.5577,-0.4693;G:-0.0144,0.0074,-0.0218;ID2;A:0.2298,9.5768,-0.3831;G:-0.0154,0.0160,-0.0138;ID2;A:0.2346,9.5529,-0.3687;G:-0.0181,0.0096,-0.0218;ID2;A:0.2538,9.5960,-0.4118;G:-0.0101,0.0101,-0.0197;ID2;A:0.2538,9.5816,-0.4070;G:-0.0160,0.0106,-0.0186;ID2;A:0.2298,9.6007,-0.4310;G:-0.0154,0.0096,-0.0234;ID2;A:0.2346,9.5433,-0.3687;G:-0.0133,0.0106,-0.0277;ID2;A:0.2442,9.6007,-0.3735;G:-0.0144,0.0117,-0.0202;ID2;A:0.2346,9.5672,-0.3783;G:-0.0133,0.0122,-0.0208;ID2;A:0.2298,9.5193,-0.4118;G:-0.0138,0.0106,-0.0250;ID2;A:0.2298,9.5529,-0.3448;G:-0.0170,0.0101,-0.0192;ID2;A:0.2442,9.5768,-0.3639;G:-0.0160,0.0117,-0.0181;ID2;A:0.2394,9.5481,-0.4214;G:-0.0181,0.0085,-0.0208;ID2;A:0.2251,9.5481,-0.4501;G:-0.0186,0.0043,-0.0218;ID2;A:0.2538,9.5624,-0.4214;G:-0.0149,0.0064,-0.0208;ID2;A:0.2442,9.5624,-0.4214;G:-0.0133,0.0096,-0.0234;ID2;A:0.2346,9.5577,-0.4405;G:-0.0133,0.0106,-0.0250;ID2;A:0.2586,9.5337,-0.4022;G:-0.0160,0.0064,-0.0234;ID2;A:0.2634,9.5529,-0.4070;G:-0.0133,0.0112,-0.0213;ID2;A:0.2155,9.5768,-0.3926;G:-0.0090,0.0170,-0.0149;ID2;A:0.2107,9.5624,-0.4022;G:-0.0138,0.0096,-0.0202;ID2;A:0.2203,9.5481,-0.3591;G:-0.0144,0.0053,-0.0229;ID2;A:0.2107,9.5960,-0.3974;G:-0.0170,0.0080,-0.0239;ID2;A:0.2298,9.5529,-0.3783;G:-0.0138,0.0122,-0.0250;ID2;A:0.2203,9.5624,-0.3831;G:-0.0106,0.0074,-0.0239;ID2;A:0.2538,9.5672,-0.3783;G:-0.0090,0.0064,-0.0181;ID2;A:0.2155,9.6055,-0.4501;G:-0.0160,0.0122,-0.0223;ID2;A:0.2251,9.5577,-0.4166;G:-0.0112,0.0085,-0.0208;ID2;A:0.2298,9.5768,-0.4214;G:-0.0090,0.0085,-0.0271;ID2;A:0.2442,9.7109,-0.3974;G:-0.0149,0.0064,-0.0239;ID2;A:0.0335,9.5816,-0.5938;G:-0.0208,0.0080,-0.0144;ID2;A:0.2107,9.5385,-0.3974;G:-0.0106,0.0117,-0.0229;ID2;A:0.2442,9.5720,-0.3974;G:-0.0149,0.0133,-0.0218;ID2;A:0.2155,9.5864,-0.4310;G:-0.0101,0.0138,-0.0202;ID2;A:0.2346,9.5577,-0.4214;G:-0.0149,0.0096,-0.0245;ID2;A:0.2634,9.5529,-0.4166;G:-0.0122,0.0117,-0.0223;ID2;A:0.2442,9.5433,-0.3879;G:-0.0117,0.0165,-0.0197;ID2;A:0.2777,9.5768,-0.4788;G:-0.0133,0.0085,-0.0176;ID2;A:0.2442,9.5768,-0.3831;G:-0.0160,0.0101,-0.0223;ID2;A:0.2298,9.5337,-0.3400;G:-0.0160,0.0059,-0.0192;ID2;A:0.2442,9.5433,-0.4597;G:-0.0160,0.0080,-0.0160;ID2;A:0.2394,9.5529,-0.3974;G:-0.0208,0.0117,-0.0234;ID2;A:0.2586,9.5481,-0.4310;G:-0.0133,0.0090,-0.0245;ID2;A:0.2107,9.5529,-0.4166;G:-0.0149,0.0101,-0.0197;ID2;A:0.2251,9.5672,-0.3735;G:-0.0096,0.0096,-0.0218;ID2;A:0.2442,9.5864,-0.4214;G:-0.0149,0.0085,-0.0223;ID2;A:0.1915,9.5720,-0.3783;G:-0.0154,0.0138,-0.0229;ID2;A:0.2442,9.5768,-0.4118;G:-0.0165,0.0112,-0.0186;ID2;A:0.2490,9.5864,-0.3256;G:-0.0101,0.0112,-0.0218;ID2;A:0.2346,9.5720,-0.4310;G:-0.0138,0.0128,-0.0218;ID2;A:0.2107,9.6007,-0.3496;G:-0.0117,0.0053,-0.0181;ID2;A:0.2634,9.5624,-0.4070;G:-0.0122,0.0069,-0.0176;ID2;A:0.2346,9.5433,-0.3639;G:-0.0181,0.0074,-0.0197;ID2;A:0.2251,9.5385,-0.3831;G:-0.0144,0.0101,-0.0192;ID2;A:0.2442,9.5720,-0.4357;G:-0.0138,0.0106,-0.0239;ID2;A:0.2203,9.6007,-0.4453;G:-0.0170,0.0085,-0.0218;ID2;A:0.2682,9.5098,-0.4118;G:-0.0138,0.0112,-0.0197;ID2;A:0.2203,9.5529,-0.4549;G:-0.0154,0.0090,-0.0176;ID2;A:0.2298,9.5385,-0.4118;G:-0.0160,0.0064,-0.0154;ID2;A:0.2586,9.5816,-0.3974;G:-0.0149,0.0122,-0.0223;ID2;A:0.2011,9.5624,-0.3783;G:-0.0138,0.0027,-0.0213;ID2;A:0.2490,9.5624,-0.3879;G:-0.0149,0.0112,-0.0202;ID2;A:0.2586,9.5481,-0.4070;G:-0.0133,0.0117,-0.0213;ID2;A:0.2011,9.5433,-0.4262;G:-0.0133,0.0096,-0.0218;ID3;A:0.1053,9.6151,-1.1205;G:-0.0154,0.0772,-0.0442;ID3;A:0.1197,9.6486,-1.1732;G:-0.0122,0.0761,-0.0442;ID3;A:0.0910,9.6247,-1.1013;G:-0.0154,0.0777,-0.0468;ID3;A:0.0958,9.6055,-1.1301;G:-0.0149,0.0788,-0.0484;ID3;A:0.1101,9.6007,-1.0918;G:-0.0154,0.0740,-0.0490;ID3;A:0.1197,9.5912,-1.0726;G:-0.0117,0.0745,-0.0452;ID3;A:0.0910,9.6151,-1.1971;G:-0.0149,0.0819,-0.0463;ID3;A:0.0862,9.5768,-1.1061;G:-0.0176,0.0729,-0.0436;ID3;A:0.1149,9.5816,-1.1349;G:-0.0144,0.0750,-0.0452;ID3;A:0.0718,9.6295,-1.1923;G:-0.0117,0.0740,-0.0479;ID3;A:0.0910,9.5624,-1.1875;G:-0.0154,0.0724,-0.0452;ID3;A:0.0766,9.6055,-1.0726;G:-0.0160,0.0777,-0.0474;ID3;A:0.0718,9.6391,-1.1540;G:-0.0112,0.0798,-0.0463;ID3;A:0.0575,9.6103,-1.1013;G:-0.0160,0.0761,-0.0463;ID3;A:0.0958,9.6199,-1.1013;G:-0.0133,0.0788,-0.0431;ID3;A:0.1053,9.6007,-1.1013;G:-0.0106,0.0798,-0.0490;ID3;A:0.0622,9.5960,-1.1109;G:-0.0138,0.0798,-0.0500;ID3;A:0.0575,9.6247,-1.1157;G:-0.0122,0.0819,-0.0436;ID3;A:0.3304,9.5002,-0.9960;G:-0.0144,0.0702,-0.0506;ID3;A:0.1820,9.6678,-1.0343;G:-0.0181,0.0777,-0.0442;ID3;A:0.0958,9.5768,-1.1157;G:-0.0138,0.0793,-0.0420;ID3;A:0.1293,9.8641,-1.1013;G:-0.0112,0.0777,-0.0474;ID3;A:0.0910,9.6199,-1.0678;G:-0.0144,0.0782,-0.0436;ID3;A:0.1101,9.5912,-1.0918;G:-0.0186,0.0756,-0.0484;ID3;A:0.0910,9.6438,-1.0774;G:-0.0165,0.0793,-0.0436;ID3;A:0.1197,9.6247,-1.1253;G:-0.0128,0.0761,-0.0436;ID3;A:0.1245,9.6295,-1.1492;G:-0.0101,0.0788,-0.0452;ID3;A:0.0670,9.6343,-1.1013;G:-0.0112,0.0777,-0.0452;ID3;A:0.0575,9.6486,-1.1588;G:-0.0154,0.0750,-0.0521;ID3;A:0.0862,9.6534,-1.1636;G:-0.0160,0.0740,-0.0468;ID3;A:0.0239,9.5720,-0.9912;G:-0.0154,0.0718,-0.0479;ID3;A:0.0622,9.6391,-1.1301;G:-0.0149,0.0756,-0.0479;ID3;A:0.0527,9.6438,-1.1109;G:-0.0154,0.0766,-0.0442;ID3;A:0.0910,9.6199,-1.0295;G:-0.0144,0.0745,-0.0431;ID3;A:0.1053,9.6151,-1.1205;G:-0.0149,0.0761,-0.0474;ID3;A:0.0814,9.6678,-1.0295;G:-0.0154,0.0761,-0.0426;ID3;A:0.0814,9.6055,-1.0918;G:-0.0154,0.0750,-0.0447;ID3;A:0.0718,9.6151,-1.0678;G:-0.0122,0.0729,-0.0468;ID3;A:0.0910,9.6007,-1.0678;G:-0.0122,0.0750,-0.0452;ID3;A:0.0958,9.6007,-1.1779;G:-0.0160,0.0809,-0.0490;ID3;A:0.1915,9.5864,-1.1013;G:-0.0160,0.0740,-0.0442;ID3;A:0.0910,9.6391,-1.0678;G:-0.0138,0.0766,-0.0452;ID3;A:0.1101,9.6055,-1.1827;G:-0.0154,0.0761,-0.0458;ID3;A:0.1053,9.6199,-1.1588;G:-0.0165,0.0777,-0.0484;ID3;A:0.0814,9.6199,-1.1349;G:-0.0154,0.0788,-0.0490;ID3;A:0.1101,9.6343,-1.1013;G:-0.0154,0.0788,-0.0426;ID3;A:0.1053,9.5768,-1.1684;G:-0.0149,0.0761,-0.0447;ID3;A:0.0622,9.6391,-1.1588;G:-0.0138,0.0761,-0.0479;ID3;A:0.0958,9.6438,-1.1109;G:-0.0192,0.0761,-0.0474;ID3;A:0.0862,9.5720,-1.1588;G:-0.0122,0.0766,-0.0426;ID3;A:0.1149,9.6486,-1.1253;G:-0.0154,0.0761,-0.0436;ID3;A:0.0622,9.6295,-1.1779;G:-0.0165,0.0777,-0.0447;ID3;A:0.0622,9.6199,-1.1253;G:-0.0133,0.0814,-0.0431;ID3;A:0.0910,9.5960,-1.1444;G:-0.0112,0.0788,-0.0447;ID3;A:0.0766,9.6103,-1.1205;G:-0.0154,0.0761,-0.0463;ID3;A:0.0910,9.6391,-1.1349;G:-0.0133,0.0766,-0.0436;ID3;A:0.0862,9.6486,-1.0439;G:-0.0112,0.0772,-0.0458;ID3;A:0.1101,9.6343,-1.1923;G:-0.0160,0.0772,-0.0484;ID3;A:0.0383,9.6055,-1.1971;G:-0.0128,0.0782,-0.0463;ID3;A:0.1101,9.6295,-1.1205;G:-0.0106,0.0750,-0.0458;ID3;A:0.1101,9.6343,-1.1061;G:-0.0181,0.0793,-0.0431;ID3;A:0.1628,9.6295,-1.1013;G:-0.0138,0.0750,-0.0506;ID3;A:0.0814,9.6007,-1.1109;G:-0.0117,0.0761,-0.0474;ID3;A:0.0670,9.5433,-1.1301;G:-0.0154,0.0761,-0.0468;ID3;A:0.0814,9.6391,-1.1253;G:-0.0133,0.0729,-0.0458;ID3;A:0.0575,9.6295,-1.1157;G:-0.0133,0.0766,-0.0484;ID3;A:0.0862,9.6007,-1.1301;G:-0.0160,0.0750,-0.0500;ID3;A:0.1197,9.5768,-1.1492;G:-0.0170,0.0750,-0.0420;ID3;A:0.0910,9.5912,-1.1157;G:-0.0160,0.0782,-0.0490;ID3;A:0.1053,9.6295,-1.0965;G:-0.0144,0.0745,-0.0490;ID3;A:0.1101,9.6103,-1.1827;G:-0.0122,0.0740,-0.0495;ID3;A:0.1101,9.6630,-1.0630;G:-0.0122,0.0777,-0.0452;ID3;A:0.0910,9.6295,-1.1492;G:-0.0112,0.0734,-0.0490;ID3;A:0.0862,9.6055,-1.1540;G:-0.0149,0.0793,-0.0420;ID3;A:0.0670,9.6103,-1.1684;G:-0.0176,0.0761,-0.0495;ID3;A:0.1149,9.6247,-1.1396;G:-0.0128,0.0761,-0.0447;ID3;A:0.0766,9.5816,-1.1253;G:-0.0096,0.0798,-0.0484;ID3;A:0.1053,9.5912,-1.1349;G:-0.0186,0.0756,-0.0468;ID3;A:0.1101,9.6247,-1.1492;G:-0.0133,0.0766,-0.0468;ID3;A:0.1341,9.6295,-1.1732;G:-0.0133,0.0766,-0.0458;ID3;A:0.0670,9.5960,-1.0822;G:-0.0122,0.0777,-0.0458;ID3;A:0.1197,9.5912,-1.0870;G:-0.0160,0.0750,-0.0426;ID3;A:0.1245,9.5529,-1.1301;G:-0.0154,0.0782,-0.0474;ID3;A:0.0814,9.6295,-1.1061;G:-0.0160,0.0756,-0.0431;ID3;A:0.1006,9.5960,-1.1923;G:-0.0128,0.0750,-0.0452;ID3;A:0.0910,9.6151,-1.1732;G:-0.0181,0.0809,-0.0468;ID3;A:0.0575,9.5960,-1.1396;G:-0.0096,0.0756,-0.0415;ID3;A:0.0622,9.6295,-1.0630;G:-0.0138,0.0788,-0.0468;ID3;A:0.0958,9.6247,-1.0678;G:-0.0181,0.0766,-0.0474;ID3;A:0.0479,9.6438,-1.1588;G:-0.0122,0.0766,-0.0474;ID3;A:0.0814,9.6247,-1.1013;G:-0.0117,0.0718,-0.0495;ID3;A:0.0479,9.6582,-1.1540;G:-0.0144,0.0724,-0.0420;ID3;A:0.0958,9.5912,-1.0630;G:-0.0160,0.0777,-0.0404;ID3;A:0.0910,9.5816,-1.1396;G:-0.0149,0.0777,-0.0426;ID3;A:0.0910,9.6295,-1.0678;G:-0.0122,0.0766,-0.0431;ID3;A:0.0910,9.6295,-1.0822;G:-0.0117,0.0772,-0.0516;ID3;A:0.0766,9.6151,-1.1205;G:-0.0122,0.0793,-0.0479;ID3;A:0.0958,9.6199,-1.1301;G:-0.0144,0.0729,-0.0442;ID3;A:0.0527,9.6103,-1.1349;G:-0.0176,0.0756,-0.0415;ID3;A:0.0862,9.5433,-1.1205;G:-0.0128,0.0750,-0.0463;ID3;A:0.1053,9.6247,-1.1013;G:-0.0144,0.0761,-0.0474;ID3;A:0.0910,9.6007,-1.1253;G:-0.0154,0.0708,-0.0484;ID3;A:0.0718,9.6582,-1.1588;G:-0.0170,0.0724,-0.0468;ID3;A:0.0862,9.6103,-1.1732;G:-0.0128,0.0772,-0.0495;ID3;A:0.1006,9.6343,-1.1684;G:-0.0138,0.0756,-0.0463;ID3;A:0.0862,9.5912,-1.0582;G:-0.0154,0.0809,-0.0458;ID3;A:0.0910,9.6486,-1.1109;G:-0.0090,0.0750,-0.0479;ID3;A:0.1197,9.6199,-1.1349;G:-0.0160,0.0782,-0.0468;ID3;A:0.1149,9.6343,-1.0870;G:-0.0144,0.0761,-0.0447;ID3;A:0.0814,9.6103,-1.1444;G:-0.0144,0.0740,-0.0426;ID3;A:0.0622,9.6151,-1.1588;G:-0.0138,0.0772,-0.0452;ID3;A:0.1149,9.6007,-1.0965;G:-0.0149,0.0718,-0.0447;ID3;A:0.0958,9.6055,-1.1157;G:-0.0138,0.0761,-0.0442;ID3;A:0.0718,9.6486,-1.1588;G:-0.0117,0.0750,-0.0468;ID3;A:0.0670,9.6438,-1.1253;G:-0.0144,0.0777,-0.0506;ID3;A:0.0766,9.6103,-1.1253;G:-0.0149,0.0724,-0.0506;ID3;A:0.0622,9.6151,-1.1396;G:-0.0101,0.0724,-0.0452;ID3;A:0.1006,9.5960,-1.1827;G:-0.0106,0.0777,-0.0463;ID3;A:0.1006,9.6151,-1.1492;G:-0.0186,0.0718,-0.0484;ID3;A:0.0814,9.5816,-1.1444;G:-0.0117,0.0734,-0.0420;ID4;A:0.0479,9.7109,-1.2977;G:-0.0490,0.0458,-0.0202;ID4;A:-0.0096,9.6822,-1.2929;G:-0.0346,0.0458,-0.0208;ID4;A:0.0383,9.7252,-1.3838;G:-0.0266,0.0415,-0.0245;ID4;A:-0.0239,9.7061,-1.3216;G:-0.0612,0.0458,-0.0197;ID4;A:0.0048,9.7396,-1.2689;G:-0.0447,0.0495,-0.0208;ID4;A:-0.0096,9.7205,-1.2929;G:-0.0330,0.0447,-0.0223;ID4;A:-0.0479,9.7252,-1.2594;G:-0.0639,0.0490,-0.0176;ID4;A:0.0096,9.6774,-1.2450;G:-0.0559,0.0474,-0.0197;ID4;A:-0.0287,9.6869,-1.3216;G:-0.0415,0.0458,-0.0218;ID4;A:0.0575,9.7205,-1.3551;G:-0.0319,0.0447,-0.0218;ID4;A:-0.0383,9.6965,-1.3120;G:-0.0537,0.0479,-0.0208;ID4;A:0.0479,9.7300,-1.2689;G:-0.0319,0.0431,-0.0223;ID4;A:0.0287,9.7300,-1.2450;G:-0.0580,0.0452,-0.0160;ID4;A:0.0048,9.7492,-1.2306;G:-0.0463,0.0490,-0.0165;ID4;A:0.0144,9.6486,-1.4700;G:-0.0495,0.0463,-0.0208;ID4;A:0.0335,9.6917,-1.3216;G:-0.0553,0.0458,-0.0160;ID4;A:-0.0287,9.6869,-1.3264;G:-0.0431,0.0474,-0.0160;ID4;A:-0.0144,9.7157,-1.2785;G:-0.0298,0.0420,-0.0239;ID4;A:-0.0431,9.6582,-1.3264;G:-0.0660,0.0468,-0.0170;ID4;A:-0.0192,10.0748,-1.2785;G:-0.0830,0.0484,-0.0144;ID4;A:0.2107,9.6822,-1.5227;G:-0.0154,0.0458,-0.0410;ID4;A:-0.0622,9.6965,-1.3264;G:-0.0867,0.0500,-0.0048;ID4;A:0.0000,9.6822,-0.8428;G:-0.0357,0.0479,-0.0160;ID4;A:-0.0527,9.6007,-1.2881;G:-0.0186,0.0452,-0.0223;ID4;A:-0.2538,9.6822,-1.5131;G:-0.0293,0.0452,-0.0367;ID4;A:0.1484,9.6869,-1.2929;G:-0.0750,0.0474,-0.0117;ID4;A:-0.0814,9.7252,-1.2641;G:-0.0718,0.0420,-0.0176;ID4;A:0.2298,9.7252,-1.2258;G:-0.0282,0.0426,-0.0250;ID4;A:-0.0670,9.6822,-1.2785;G:-0.0335,0.0474,-0.0255;ID4;A:0.0670,9.6726,-1.3072;G:-0.0234,0.0458,-0.0250;ID4;A:0.0144,9.7396,-1.2450;G:-0.0149,0.0442,-0.0213;ID4;A:0.0766,9.7348,-1.2594;G:-0.0681,0.0463,-0.0181;ID4;A:-0.0575,9.7683,-1.2641;G:-0.0617,0.0506,-0.0128;ID4;A:0.1341,9.7061,-1.3072;G:-0.0468,0.0452,-0.0208;ID4;A:-0.0287,9.7396,-1.2929;G:-0.0420,0.0410,-0.0218;ID4;A:-0.0192,9.7157,-1.2641;G:-0.0287,0.0521,-0.0213;ID4;A:0.0192,9.6678,-1.6424;G:-0.0612,0.0484,-0.0176;ID4;A:-0.0958,9.7300,-1.2450;G:-0.0500,0.0463,-0.0186;ID4;A:0.0527,9.7109,-1.2450;G:-0.0399,0.0527,-0.0255;ID4;A:-0.0766,9.7013,-1.4605;G:-0.0596,0.0463,-0.0186;ID4;A:0.0335,9.7157,-1.2641;G:-0.0479,0.0436,-0.0197;ID4;A:0.0431,9.6917,-1.3120;G:-0.0585,0.0463,-0.0170;ID4;A:0.0622,9.6965,-1.3072;G:-0.0357,0.0463,-0.0255;ID4;A:-0.1772,9.7396,-1.1923;G:-0.0649,0.0490,-0.0101;ID4;A:0.0862,9.7061,-1.3743;G:-0.0841,0.0506,-0.0144;ID4;A:0.0287,9.7157,-1.3072;G:-0.0287,0.0468,-0.0181;ID4;A:0.0527,9.7061,-1.2689;G:-0.0484,0.0474,-0.0202;ID4;A:-0.0335,9.6965,-1.2833;G:-0.0511,0.0511,-0.0165;ID4;A:0.0670,9.7013,-1.2785;G:-0.0394,0.0495,-0.0239;ID4;A:0.0239,9.7061,-1.2977;G:-0.0357,0.0447,-0.0229;ID4;A:0.0527,9.6917,-1.2785;G:-0.0239,0.0447,-0.0229;ID4;A:-0.0239,9.6726,-1.6281;G:-0.0665,0.0420,-0.0154;ID4;A:-0.0239,9.6917,-1.3168;G:-0.0617,0.0511,-0.0160;ID4;A:0.0814,9.7109,-1.3024;G:-0.0548,0.0452,-0.0176;ID4;A:-0.0144,9.6822,-1.2929;G:-0.0426,0.0458,-0.0213;ID4;A:0.0287,9.7588,-1.2881;G:-0.0351,0.0452,-0.0218;ID4;A:-0.0096,9.6869,-1.2641;G:-0.0255,0.0458,-0.0223;ID4;A:0.0575,9.7013,-1.2785;G:-0.0628,0.0420,-0.0154;ID4;A:-0.0431,9.6678,-1.2977;G:-0.0458,0.0479,-0.0213;ID4;A:0.0335,9.6965,-1.2737;G:-0.0330,0.0468,-0.0202;ID4;A:-0.0144,9.6917,-1.2641;G:-0.0564,0.0458,-0.0170;ID4;A:0.0239,9.6869,-1.2785;G:-0.0383,0.0495,-0.0197;ID4;A:0.0192,9.6678,-1.2977;G:-0.0532,0.0484,-0.0181;ID4;A:-0.0239,9.7109,-1.3982;G:-0.0388,0.0490,-0.0192;ID4;A:0.0192,9.7157,-1.2258;G:-0.0452,0.0452,-0.0165;ID4;A:0.0479,9.6822,-1.3791;G:-0.0564,0.0458,-0.0170;ID4;A:0.0096,9.7205,-1.2641;G:-0.0357,0.0447,-0.0218;ID4;A:-0.0192,9.7300,-1.2737;G:-0.0468,0.0452,-0.0197;ID4;A:-0.0335,9.7300,-1.3360;G:-0.0521,0.0442,-0.0213;ID4;A:-0.0144,9.7061,-1.3216;G:-0.0521,0.0479,-0.0186;ID4;A:-0.0192,9.7157,-1.3408;G:-0.0500,0.0468,-0.0202;ID4;A:0.0335,9.6869,-1.3695;G:-0.0490,0.0458,-0.0234;ID4;A:0.0239,9.7013,-1.3120;G:-0.0468,0.0452,-0.0170;ID4;A:0.0622,9.7157,-1.3838;G:-0.0458,0.0495,-0.0202;ID4;A:0.0431,9.7348,-1.3408;G:-0.0442,0.0527,-0.0176;ID4;A:0.0000,9.7109,-1.2929;G:-0.0490,0.0447,-0.0181;ID4;A:0.0335,9.6965,-1.2450;G:-0.0436,0.0442,-0.0218;ID4;A:0.0239,9.7252,-1.3120;G:-0.0479,0.0442,-0.0181;ID4;A:0.0575,9.6965,-1.2737;G:-0.0500,0.0420,-0.0181;ID4;A:0.0048,9.6917,-1.3360;G:-0.0490,0.0490,-0.0223;ID4;A:0.0192,9.7157,-1.3599;G:-0.0468,0.0431,-0.0197;ID4;A:0.0479,9.6917,-1.3072;G:-0.0458,0.0484,-0.0186;ID4;A:-0.0192,9.6965,-1.3791;G:-0.0495,0.0490,-0.0197;ID4;A:0.0192,9.6678,-1.2785;G:-0.0463,0.0447,-0.0176;ID4;A:0.0144,9.6822,-1.3360;G:-0.0479,0.0463,-0.0223;ID4;A:-0.0144,9.7157,-1.3024;G:-0.0479,0.0474,-0.0208;ID4;A:0.0383,9.6534,-1.3168;G:-0.0452,0.0495,-0.0213;ID4;A:0.0048,9.7205,-1.3072;G:-0.0468,0.0442,-0.0197;ID4;A:0.0383,9.7157,-1.3168;G:-0.0500,0.0442,-0.0202;ID4;A:-0.0048,9.6726,-1.4030;G:-0.0516,0.0479,-0.0239;ID4;A:0.0144,9.7013,-1.3743;G:-0.0479,0.0490,-0.0208;ID4;A:0.0096,9.7013,-1.2737;G:-0.0495,0.0442,-0.0186;ID4;A:-0.0096,9.7109,-1.2977;G:-0.0484,0.0452,-0.0202;ID4;A:0.0096,9.7348,-1.3455;G:-0.0468,0.0463,-0.0165;ID4;A:0.0192,9.7061,-1.3408;G:-0.0484,0.0527,-0.0245;ID4;A:-0.0192,9.6965,-1.2785;G:-0.0495,0.0458,-0.0213;ID4;A:0.0192,9.6726,-1.2977;G:-0.0479,0.0468,-0.0181;ID4;A:-0.0096,9.7157,-1.3168;G:-0.0506,0.0458,-0.0218;ID4;A:-0.0335,9.7157,-1.3168;G:-0.0479,0.0463,-0.0208;ID4;A:0.0527,9.6774,-1.3024;G:-0.0484,0.0484,-0.0149;ID4;A:-0.0479,9.7396,-1.4174;G:-0.0527,0.0458,-0.0186;ID4;A:0.0096,9.6917,-1.3120;G:-0.0394,0.0447,-0.0245;ID4;A:0.0144,9.6965,-1.3503;G:-0.0410,0.0479,-0.0223;ID4;A:0.0239,9.6965,-1.4222;G:-0.0474,0.0410,-0.0181;ID4;A:-0.0239,9.7013,-1.3216;G:-0.0431,0.0490,-0.0181;ID4;A:0.0096,9.7300,-1.3982;G:-0.0468,0.0420,-0.0186;ID4;A:0.0431,9.6822,-1.2929;G:-0.0479,0.0468,-0.0181;ID4;A:0.0239,9.6869,-1.3216;G:-0.0463,0.0479,-0.0218;ID4;A:0.0287,9.7205,-1.2977;G:-0.0468,0.0436,-0.0218;ID4;A:0.0048,9.7252,-1.3360;G:-0.0458,0.0447,-0.0176;ID4;A:0.0192,9.7252,-1.3408;G:-0.0479,0.0431,-0.0192;ID4;A:0.0239,9.7109,-1.3408;G:-0.0458,0.0447,-0.0229;ID4;A:0.0335,9.7205,-1.2546;G:-0.0495,0.0410,-0.0192;ID4;A:0.0096,9.7013,-1.3360;G:-0.0426,0.0447,-0.0181;ID4;A:-0.0192,9.6774,-1.2881;G:-0.0452,0.0442,-0.0197;ID4;A:-0.0335,9.7396,-1.3216;G:-0.0506,0.0458,-0.0186;ID4;A:0.0335,9.7252,-1.1875;G:-0.0500,0.0490,-0.0186;ID4;A:-0.0144,9.6726,-1.3791;G:-0.0458,0.0463,-0.0234;ID4;A:0.0096,9.6965,-1.2306;G:-0.0516,0.0495,-0.0218;ID4;A:0.0383,9.6869,-1.3695;G:-0.0463,0.0468,-0.0181;ID4;A:0.0048,9.7492,-1.3168;G:-0.0521,0.0479,-0.0176;ID4;A:0.0718,9.7492,-1.3216;G:-0.0495,0.0516,-0.0176;ID4;A:-0.0239,9.7109,-1.2785;G:-0.0479,0.0490,-0.0192;ID4;A:-0.0144,9.6822,-1.2881;G:-0.0474,0.0479,-0.0197;ID4;A:0.0096,9.7252,-1.2785;G:-0.0490,0.0447,-0.0197;ID4;A:0.0144,9.7205,-1.3455;G:-0.0452,0.0490,-0.0213;ID4;A:0.0096,9.6965,-1.2689;G:-0.0484,0.0468,-0.0197;ID4;A:-0.0096,9.7252,-1.2737;G:-0.0463,0.0436,-0.0218;ID4;A:-0.0096,9.7061,-1.3312;G:-0.0447,0.0463,-0.0186;ID4;A:0.0287,9.7444,-1.3072;G:-0.0463,0.0420,-0.0154;ID4;A:0.0096,9.6869,-1.3120;G:-0.0463,0.0474,-0.0170;ID4;A:0.0192,9.7061,-1.2881;G:-0.0458,0.0463,-0.0208;ID4;A:0.0000,9.6869,-1.3216;G:-0.0484,0.0442,-0.0181;ID4;A:0.0287,9.6774,-1.3455;G:-0.0484,0.0458,-0.0202;ID4;A:0.0287,9.7444,-1.2785;G:-0.0495,0.0463,-0.0181;ID4;A:-0.0048,9.6965,-1.4317;G:-0.0506,0.0426,-0.0170;ID4;A:-0.0096,9.7300,-1.3886;G:-0.0458,0.0458,-0.0234;ID4;A:-0.0048,9.6869,-1.3072;G:-0.0474,0.0468,-0.0213;ID4;A:0.0096,9.7013,-1.4174;G:-0.0479,0.0463,-0.0213;ID4;A:0.0048,9.7205,-1.3264;G:-0.0468,0.0468,-0.0181;"
print(correct_sensor_data(raw, 4))